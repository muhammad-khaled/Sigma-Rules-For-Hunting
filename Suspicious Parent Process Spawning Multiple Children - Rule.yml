title: Suspicious Parent Process Spawning Multiple Children
id: 3f8c2e4e-7b9d-4a2f-9c3a-1e2d4f6b8a9c  
status: experimental
description: Flags known LOLBins or scripting engines that may spawn multiple child processes
author: Mohamed Khaled Ibrahim
date: 2025/08/28
logsource:
  category: process_creation
  product: windows
detection:
  selection:
    ParentImage|endswith:
      - '\powershell.exe'
      - '\cmd.exe'
      - '\wscript.exe'
      - '\mshta.exe'
      - '\rundll32.exe'
  condition: selection
fields:
  - ParentImage
  - ParentCommandLine
  - ChildImage
  - ChildCommandLine
  - ParentProcessGuid
  - User
  - Hostname
tags:
  - attack.execution
  - attack.defense_evasion
  - attack.t1059
falsepositives:
  - legitimate automation scripts
level: medium