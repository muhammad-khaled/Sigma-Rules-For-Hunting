title: Powershell Obfuscation Command Usage
id: 3a7f9c2d-1e4b-4d6a-9f8c-2b5f1a7c6d3e
status: experimental
description: Detects usage of obfuscation techniques in PowerShell commands, which may indicate evasion or malicious scripting
author: Mohamed Khaled Ibrahim
date: 2025/08/28
logsource:
  category: process_creation
  product: windows
detection:
  selection:
    Image|endswith: '\powershell.exe'
    CommandLine|contains:
      - 'FromBase64String'
      - 'Invoke-Expression'
      - 'IEX'
      - 'New-Object Net.WebClient'
      - 'GetString'
      - 'DownloadString'
      - 'Join-String'
      - 'Split'
      - 'Replace'
      - 'Concat'
  condition: selection
fields:
  - Image
  - CommandLine
  - ParentImage
  - User
  - Hostname
tags:
  - attack.defense_evasion
  - attack.execution
  - attack.t1059.001
falsepositives:
  - legitimate administrative scripts or encoded automation
level: high